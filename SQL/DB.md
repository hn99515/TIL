# Database

## ▶️ Database 의 기본 기능

1️⃣ **데이터의 검색 (`SELECT`)**

> **검색 = 추출, 질의**

* **데이터베이스의 가장 중요한 기능**
  
  * **데이터 분석을 한다는 것은 기존에 있는 데이터를 변형하는게 아니라, 있는 데이터에서 정보를 뽑아내는 것을 의미!**

* 검색 기능이 DB에 있는 정보를 불러오는 것

* *데이터 추출은 데이터베이스에 저장되어 있는 원본 데이터 자체를 변형하는 것은 아니다.*

```sql
SELECT *
FROM <table_name>
WHERE <column_name> LIKE 'Lee%'
```

2️⃣ **데이터의 갱신 (`UPDATE ~ SET ~`, `DELETE`, `INSERT INTO ~ VALUES(~)`)**

* **새로운 데이터를 추가하고, 기존 데이터를 수정하고, 불필요해진 데이터를 삭제하는 것이 가능**

* **① 수정 (`UPDATE ~ SET ~`)**

```sql
UPDATE <table_name> SET <column_name> = <update_content>
WHERE <column_name> = <column_content>
```

* **② 삭제 (`DELETE FROM ~`)**
  
  * 특정 데이터 1줄을 삭제

```sql
DELETE FROM <table_name> WHERE <column_name> = <column_content>
```

* **③ 새로운 데이터 추가`(INSERT INTO ~ VALUES ~)`** 
  
  * 기존 테이블의 열에 맞게 모든 내용을 작성해주어야 1개의 데이터가 추가됨
  
  * 열에 맞는 값이 없는 경우 `NULL` 로 표기 가능

```sql
INSERT INTO <table_name> VALUES(<update_content>)
```

3️⃣ **동시성 제어**

> **DB에 많은 사용자가 동시에 접근 = 동시에 여러 사용자로부터 검색, 갱신 요청을 받음**

* **3가지 경우의 수**
  
  * 1. 최초로 파일은 연 사람이 파일을 열고 있을 때 그 다음 사람은 파일을 열 수 없다.
  
  * 2. 최초로 파일을 연 사람이 파일을 열고 있을 때 그 다음 사람은 읽기 전용으로만 열 수 있다.
  
  * 3. *모든 사람이 파일을 열 수 있고 마지막에 수행된 쪽의 결과가 갱신되어 반영된다.*

* **실제 데이터베이스들은 1번과 2번 방식으로 한 동시성 제어가 많음**
  
  * 3번의 경우 Dirty Write 라고도 하며 선호되는 방식은 아님

4️⃣ **장애 대응**

* 데이터베이스는 데이터를 한 곳이 아니라 복수의 장소에 분산해서 저장하는 등 데이터를 보호하고, 장애에 대응할 수 있어야 함
  
  * 예) 구글은 개인정보를 복사해 여러 컴퓨터에 나누어 저장하며 그 컴퓨터들은 한 국가에 있지 않고, 여러 국가에 존재

5️⃣ **보안**

> **데이터베이스에 보존된 데이터를 어떻게 숨길 것인가?**

* 예) 은행 데이터베이스 = 나만 계좌를 확인할 수 있어야 함

* *데이터는 중요한 정보들을 담고 있는 경우가 많기 때문에 데이터 베이스는 해킹 등 외부의 공격에도 뚫리지 않아야 함*

## ▶️ 데이터베이스의 종류

1️⃣ **관계형 데이터베이스**

* **2차원 표 형식으로 관리하는 데이터베이스**

* 현재 가장 주류를 이루고 있음
  
  * 예) MySQL, ORACLE, SQLite 등

2️⃣ NoSQL 데이터베이스

* Not Only SQL

* 대량의 데이터를 고속으로 처리해야 하는 웹 서비스에서 자주 사용됨
  
  * 예) redis, mongoDB 등

3️⃣ 계층형 데이터베이스

* 데이터를 계층 구조로 관리하는 데이터베이스
  
  * 예) 조직도 등

# DB 설계

## 1. DB 설계의 목적

* 프로젝트, 명세서 등의 정보 요구사항에 대한 정확한 이해

* 분석자, 개발자, 사용자간의 원활한 의사소통 수단

* 데이터 중심의 분석 방법

* 현행 시스템만이 아닌 신규 시스템 개발의 기초 제공

## 2. 설계를 위한 요구사항 분석

* 데이터베이스에 대한 사용자의 요구사항을 수집하고 분석해서 요구사항(기능) 명세서를 작성

## 3. 개념적 설계

* 작성한 요구사항 명세서에서 데이터베이스를 구성하는데 필요한 개체, 속성, 개체 간의 관계를 추출하여 ERD를 생성
  
  * 개체와 속성 추출 : 대부분 명사로 선별
  
  * 개체 간의 관계 추출 : 대부분 동사로 선별

### 3.1 개체와 속성 추출

* 요구사항에서 개체는 대부분 명사로 이루어지지만, 속성과 구별하여 추출
  
  * 개체 : 회원, 신용카드, 비행기, 좌석 등
  
  * 속성 : 아이디, 비밀번호, 성명, 카드번호, 유효기간, 비행기번호 등

### 3.2 개체 간의 관계 추출

* 개체 간의 관계는 여러가지로 분류해서 정의
  
  * 회원의 신용카드 정보는 여러 개를 저장할 수 있음
  
  * 회원 한 명은 좌석을 하나만 예약 가능
  
  * 한 좌석은 회원 한 명만 예약 가능

## 4. 논리적 설계

> **모든 개체는 테이블(릴레이션)로 변환**

* N:M 관계는 테이블로 변환
  
  * 관계 = 릴레이션 이름
  
  * 관계속성 = 릴레이션 속성

* 1:N 관계는 외래키로 표현
  
  * 1측 개체의 기본키를 N측 릴레이션에 포함시키고 외래키로 지정

* 1:1 관계는 외래키로 표현
  
  * 외래키를 서로 주고 받음

* 다중값 속성은 독립 테이블(릴레이션)로 변환
  
  * 릴레이션에서는 다중 값 속성을 가질 수 없으므로 다중 값 속성은 별도의 릴레이션으로 생성해야 함

## 5. 물리적 스키마 및 구현

> **ERD를 실제 테이블로 생성**

# 반정규화

> **정규화란 데이터 모델의 중복을 최소화하고 데이터의 일관성, 유연성을 확보하기 위한 목적으로 데이터를 분해하는 과정**

* 정규화 모델 단점
  
  * *여러 테이블이 생성되어야 하므로 테이블 조인이 빈번하게 발생하여 성능저하 우려*

* **반정규화란 정규화된 엔티티타입, 속성, 관계를 시스템의 성능향상, 개발과 운영의 단순화를 위해 모델을 통합하는 프로세스**
  
  * **DB의 성능 향상을 위해, 데이터 중복을 허용하고 조인을 줄이는 데이터베이스 성능 향상 방법**

* 반정규화 모델 단점
  
  * *같은 데이터가 여러 테이블에 존재하므로 무결성이 깨질 우려*

## ▶ 반정규화 방법

* 1:1 관계의 테이블 병합

* 1:N 관계의 테이블 병합

* 수퍼/서브 타입 테이블 병합

* 수직 분할 : 집중화된 일부 컬럼을 분리

* 수평 분할 : 행으로 구분하여 구간별 분리

* 테이블 추가 : 중복테이블, 통계테이블, 이력케이블, 부분테이블
  
  * 중복 컬럼 추가 : 자주 조회하는 컬럼이 있는 경우
  
  * 파생 컬럼 추가 : 미리 계산한 값
  
  * PK에 의한 컬럼 추가
  
  * 응용시스템 오작동을 위한 컬럼 추가 (이전데이터 임시 보관)


